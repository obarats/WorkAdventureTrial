import{writable as t,derived as r}from"svelte/store";const e=/(\{(?:[^{}]+|\{(?:[^{}]+)*\})*\})/g,n=t=>t.substring(1,t.length-1),o=(t,r=!0,o="",s="")=>t.split(e).map((t=>{if(!t.match(e))return t;const r=n(t);if(r.startsWith("{"))return((t,r)=>{let[e,n]=t.split(":");n||(n=e,e=r);const o=n.split("|"),[s,i,l,c,a,u]=o,f=o.filter((t=>void 0!==t)).length;return 1===f?{k:e,r:s}:2===f?{k:e,o:s,r:i}:3===f?{k:e,z:s,o:i,r:l}:{k:e,z:s,o:i,t:l,f:c,m:a,r:u}})(n(r),s);const i=(t=>{const[r="",...e]=t.split("|"),[n="",o]=r.split(":"),[s,i]=n.split("?");return{k:s,i:o,n:""===i,f:e}})(r);return s=i.k||s,!o&&(o=s),i})).map((t=>{if("string"==typeof t)return t;t.k||(t.k=o||"0");const e=(t=>Object.fromEntries(Object.keys(t).map((r=>{var e;const n=t[r];return[r,Array.isArray(n)?n.map((t=>null==t?void 0:t.trim())):n===!!n?n:null===(e=n)||void 0===e?void 0:e.trim()]}))))(t);return r?(n=e,Object.fromEntries(Object.entries(n).map((([t,r])=>"i"!==t&&r&&"0"!=r&&[t,r])).filter(Boolean))):e;var n})),s=/^\{.*\}$/,i=/\?\?/g,l=(t,r,e,o)=>t.map((t=>{if("string"==typeof t)return t;const{k:l="0",f:c=[]}=t,a=o[l];if((t=>!(!t.o&&!t.r))(t))return(("boolean"==typeof a?a?t.o:t.r:((t,{z:r,o:e,t:n,f:o,m:s,r:i},l)=>{switch(r&&0==l?"zero":t.select(l)){case"zero":return r;case"one":return e;case"two":return n;case"few":return o;case"many":return s;default:return i}})(r,t,a))||"").replace(i,a);const u=c.length?((t,r,e)=>r.reduce(((r,e)=>{var o,i;return null!==(i=e.match(s)?(()=>{var t;const o=Object.fromEntries(n(e).split(",").map((t=>t.split(":").map((t=>t.trim())))));return null!==(t=o[r])&&void 0!==t?t:o["*"]})():null===(o=t[e])||void 0===o?void 0:o.call(t,r))&&void 0!==i?i:r}),e))(e,c,a):a;return(""+(null!=u?u:"")).trim()})).join(""),c=t=>new Proxy(t?()=>t:{},{get:(r,e)=>c(t?`${t}.${e}`:e)}),a=(t,r,e)=>{const n={},s=new Intl.PluralRules(t);return(t,...i)=>((t,r,e,n)=>{const o=n[0],s=o&&"object"==typeof o&&o.constructor===Object,i=1===n.length&&s?o:n;return l(t,r,e,i)})(((t,r)=>t[r]||(t[r]=o(r)))(n,((t,r)=>{var e;return r.split(".").forEach((r=>t=t[r])),null!==(e=t)&&void 0!==e?e:r})(r,t)),s,e,i)};const u=(t,r,e={})=>new Proxy(r?t.bind(null,r):e,{get:(e,n)=>u(t,r?`${r}.${n}`:n)}),{initI18n:f,setLocale:p,isLoadingLocale:m,locale:d,LL:v}=((e="")=>{const n=t(e),o=t(!1);let s=c();const i=t(s);let l,f;const p=async t=>{if(!t||!l)return;o.set(!0);const r=await l(t);s=function(t,r,e={}){return u(a(t,r,e))}(t,r,await f(t)),i.set(s),n.set(t),o.set(!1)},m=r(n,((t,r)=>r(t))),d=r(o,((t,r)=>r(t))),v=new Proxy({},{get:(t,r)=>"subscribe"===r?i.subscribe:s[r]});return{initI18n:async(t,r,e)=>{l=r,f=e||(()=>({})),await p(t)},setLocale:p,isLoadingLocale:d,locale:m,LL:v}})();export{v as LL,v as default,f as initI18n,m as isLoadingLocale,d as locale,p as setLocale};
