const t=/(\{(?:[^{}]+|\{(?:[^{}]+)*\})*\})/g,r=t=>t.substring(1,t.length-1),e=(e,n=!0,o="",i="")=>e.split(t).map((e=>{if(!e.match(t))return e;const n=r(e);if(n.startsWith("{"))return((t,r)=>{let[e,n]=t.split(":");n||(n=e,e=r);const o=n.split("|"),[i,s,a,l,c,u]=o,h=o.filter((t=>void 0!==t)).length;return 1===h?{k:e,r:i}:2===h?{k:e,o:i,r:s}:3===h?{k:e,z:i,o:s,r:a}:{k:e,z:i,o:s,t:a,f:l,m:c,r:u}})(r(n),i);const s=(t=>{const[r="",...e]=t.split("|"),[n="",o]=r.split(":"),[i,s]=n.split("?");return{k:i,i:o,n:""===s,f:e}})(n);return i=s.k||i,!o&&(o=i),s})).map((t=>{if("string"==typeof t)return t;t.k||(t.k=o||"0");const r=(t=>Object.fromEntries(Object.keys(t).map((r=>{var e;const n=t[r];return[r,Array.isArray(n)?n.map((t=>null==t?void 0:t.trim())):n===!!n?n:null===(e=n)||void 0===e?void 0:e.trim()]}))))(t);return n?(e=r,Object.fromEntries(Object.entries(e).map((([t,r])=>"i"!==t&&r&&"0"!=r&&[t,r])).filter(Boolean))):r;var e})),n=/^\{.*\}$/,o=/\?\?/g,i=(t,e,i,s)=>t.map((t=>{if("string"==typeof t)return t;const{k:a="0",f:l=[]}=t,c=s[a];if((t=>!(!t.o&&!t.r))(t))return(("boolean"==typeof c?c?t.o:t.r:((t,{z:r,o:e,t:n,f:o,m:i,r:s},a)=>{switch(r&&0==a?"zero":t.select(a)){case"zero":return r;case"one":return e;case"two":return n;case"few":return o;case"many":return i;default:return s}})(e,t,c))||"").replace(o,c);const u=l.length?((t,e,o)=>e.reduce(((e,o)=>{var i,s;return null!==(s=o.match(n)?(()=>{var t;const n=Object.fromEntries(r(o).split(",").map((t=>t.split(":").map((t=>t.trim())))));return null!==(t=n[e])&&void 0!==t?t:n["*"]})():null===(i=t[o])||void 0===i?void 0:i.call(t,e))&&void 0!==s?s:e}),o))(i,l,c):c;return(""+(null!=u?u:"")).trim()})).join(""),s=t=>new Proxy(t?()=>t:{},{get:(r,e)=>s(t?`${t}.${e}`:e)}),a=(t,r,n)=>{const o={},s=new Intl.PluralRules(t);return(t,...a)=>((t,r,e,n)=>{const o=n[0],s=o&&"object"==typeof o&&o.constructor===Object,a=1===n.length&&s?o:n;return i(t,r,e,a)})(((t,r)=>t[r]||(t[r]=e(r)))(o,((t,r)=>{var e;return r.split(".").forEach((r=>t=t[r])),null!==(e=t)&&void 0!==e?e:r})(r,t)),s,n,a)};const l=(t,r,e={})=>new Proxy(r?t.bind(null,r):e,{get:(e,n)=>l(t,r?`${r}.${n}`:n)}),c=t=>new Proxy(t,{get:(r,e)=>!(r===t&&"then"===e)&&t[e]});class u{constructor(t="",r=(()=>({})),e=(()=>({}))){this.baseLocale=t,this.getTranslationForLocale=r,this.initFormatters=e,this._isLoadingLocale=!1,this.currentLocale=null,this._LL=c(s())}async initI18n(t=this.baseLocale){await this.setLocale(t)}get isLoadingLocale(){return this._isLoadingLocale}get LL(){return this._LL}get locale(){return this.currentLocale}async setLocale(t){const r=this.getTranslationForLocale(t),e=this.initFormatters(t);this._LL=c(function(t,r,e={}){return l(a(t,r,e))}(t,r instanceof Promise?await r:r,e instanceof Promise?await e:e)),this.currentLocale=t}}export{u as I18nServiceRoot};
